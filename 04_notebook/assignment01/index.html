<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="!!AT THE VERY END OF THE PAGE YOU CAN FIND THE COMPLETE PDF REPORT!! 1. Histogram equalization We can achieve histogram equalization in two main ways: Equalize every channel in the RGB image and then stack them together again Convert the image into a format where the luminance is isolated perform histogram normalization on that channel and then convert back the image to RGB RGB channels equalization 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # Some code to create the histograms and images def create_histogram_rgb(img=None): fig, axs = plt."><title>Gray-algorithms and histogram equalization</title>
<link rel=canonical href=https://sebo-the-tramp.github.io/04_notebook/assignment01/><link rel=stylesheet href=/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css><meta property='og:title' content="Gray-algorithms and histogram equalization"><meta property='og:description' content="!!AT THE VERY END OF THE PAGE YOU CAN FIND THE COMPLETE PDF REPORT!! 1. Histogram equalization We can achieve histogram equalization in two main ways: Equalize every channel in the RGB image and then stack them together again Convert the image into a format where the luminance is isolated perform histogram normalization on that channel and then convert back the image to RGB RGB channels equalization 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # Some code to create the histograms and images def create_histogram_rgb(img=None): fig, axs = plt."><meta property='og:url' content='https://sebo-the-tramp.github.io/04_notebook/assignment01/'><meta property='og:site_name' content='Sebastian Cavada'><meta property='og:type' content='article'><meta property='article:section' content='04_notebook'><meta property='article:published_time' content='2023-09-10T14:31:13+02:00'><meta property='article:modified_time' content='2023-09-10T14:31:13+02:00'><meta name=twitter:title content="Gray-algorithms and histogram equalization"><meta name=twitter:description content="!!AT THE VERY END OF THE PAGE YOU CAN FIND THE COMPLETE PDF REPORT!! 1. Histogram equalization We can achieve histogram equalization in two main ways: Equalize every channel in the RGB image and then stack them together again Convert the image into a format where the luminance is isolated perform histogram normalization on that channel and then convert back the image to RGB RGB channels equalization 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # Some code to create the histograms and images def create_histogram_rgb(img=None): fig, axs = plt."><link rel=icon href=/logo.svg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/big_hu17844177664158792560.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ðŸš€</span></figure><div class=site-meta><h1 class=site-name><a href=/>Sebastian Cavada</a></h1><h2 class=site-description>If you are not building stuff, don't stop people who are!</h2></div></header><ol class=menu-social><li><a href=https://github.com/Sebo-the-tramp target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://github.com/Sebo-the-tramp target=_blank title=Linkedin rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-linkedin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a href=https://mobile.twitter.com/_cavada target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://www.youtube.com/channel/UCe2CkR9ldskNh_mVSwpeiLw target=_blank title=Youtube rel=me><svg class="icon icon-tabler icon-tabler-brand-youtube" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="4"/><path d="M10 9l5 3-5 3z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>Whoami</span></a></li><li><a href=/post/><svg class="icon icon-tabler icon-tabler-book" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 19a9 9 0 019 0 9 9 0 019 0"/><path d="M3 6a9 9 0 019 0 9 9 0 019 0"/><line x1="3" y1="6" x2="3" y2="19"/><line x1="12" y1="6" x2="12" y2="19"/><line x1="21" y1="6" x2="21" y2="19"/></svg>
<span>Blog</span></a></li><li><a href=/02_publications/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-certificate-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 15m-3 0a3 3 0 106 0 3 3 0 10-6 0"/><path d="M10 7h4"/><path d="M10 18v4l2-1 2 1v-4"/><path d="M10 19H8a2 2 0 01-2-2V5a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2h-2"/></svg>
<span>Publications</span></a></li><li><a href=/03_projects/><svg class="icon icon-tabler icon-tabler-circle-square" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="9.5" cy="9.5" r="6.5"/><rect x="10" y="10" width="11" height="11" rx="2"/></svg>
<span>Projects</span></a></li><li class=current><a href=/04_notebook/><svg class="icon icon-tabler icon-tabler-school" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 9 12 5 2 9l10 4 10-4v6"/><path d="M6 10.6V16a6 3 0 0012 0v-5.4"/></svg>
<span>Notebook</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-histogram-equalization>1. Histogram equalization</a><ol><li><a href=#rgb-channels-equalization>RGB channels equalization</a></li><li><a href=#hsi-intensity-equalization>HSI intensity equalization</a></li><li><a href=#the-same-result-was-reproduced-with-another-base-image-to-check-that-the-results-were-similar-and-coherrent>The same result was reproduced with another base image to check that the results were similar and coherrent</a></li></ol></li><li><a href=#2-contrast-streching>2. Contrast streching</a><ol><li><a href=#clipping>Clipping</a></li></ol></li><li><a href=#thresholding>Thresholding</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/04_notebook/assignment01/>Gray-algorithms and histogram equalization</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 10, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>11 minute read</time></div></footer></div></header><section class=article-content><p><strong>!!AT THE VERY END OF THE PAGE YOU CAN FIND THE COMPLETE PDF REPORT!!</strong></p><h2 id=1-histogram-equalization>1. Histogram equalization</h2><p>We can achieve histogram equalization in two main ways:</p><ul><li>Equalize every channel in the RGB image and then stack them together again</li><li>Convert the image into a format where the luminance is isolated perform histogram normalization on that channel and then convert back the image to RGB</li></ul><h3 id=rgb-channels-equalization>RGB channels equalization</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Some code to create the histograms and images </span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_histogram_rgb</span><span class=p>(</span><span class=n>img</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>        
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=s1>&#39;RGB Histogram and corresponding image&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>set_size_inches</span><span class=p>(</span><span class=mf>18.5</span><span class=p>,</span> <span class=mf>5.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>color</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;red&#39;</span><span class=p>,</span><span class=s1>&#39;green&#39;</span><span class=p>,</span><span class=s1>&#39;blue&#39;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cdfs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mi>256</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>hists</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>tot_max_cdf</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>col</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>color</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>hist</span><span class=p>,</span><span class=n>_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>histogram</span><span class=p>(</span><span class=n>img</span><span class=p>[:,:,</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>flatten</span><span class=p>(),</span><span class=mi>256</span><span class=p>,[</span><span class=mi>0</span><span class=p>,</span><span class=mi>256</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>cdf</span> <span class=o>=</span> <span class=n>hist</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>hists</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>hist</span><span class=p>)</span>        
</span></span><span class=line><span class=cl>        <span class=n>cdfs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>cdf</span>               
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>cdf</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>tot_max_cdf</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>tot_max_cdf</span> <span class=o>=</span> <span class=n>cdf</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>col</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>color</span><span class=p>):</span>        
</span></span><span class=line><span class=cl>        <span class=n>cdf_normalized</span> <span class=o>=</span> <span class=n>cdfs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=nb>float</span><span class=p>(</span><span class=n>hists</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>())</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>cdfs</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>                     
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>cdf_normalized</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;orange&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>hist</span><span class=p>(</span><span class=n>img</span><span class=p>[:,:,</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>ravel</span><span class=p>(),</span><span class=mi>256</span><span class=p>,[</span><span class=mi>0</span><span class=p>,</span><span class=mi>256</span><span class=p>],</span> <span class=n>color</span> <span class=o>=</span> <span class=n>col</span><span class=p>)</span>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=s1>&#39;cdf&#39;</span><span class=p>,</span><span class=s1>&#39;histogram&#39;</span><span class=p>),</span> <span class=n>loc</span> <span class=o>=</span> <span class=s1>&#39;upper left&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=s1>&#39;cdf&#39;</span><span class=p>,</span><span class=s1>&#39;histogram&#39;</span><span class=p>),</span> <span class=n>loc</span> <span class=o>=</span> <span class=s1>&#39;upper left&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=s1>&#39;cdf&#39;</span><span class=p>,</span><span class=s1>&#39;histogram&#39;</span><span class=p>),</span> <span class=n>loc</span> <span class=o>=</span> <span class=s1>&#39;upper left&#39;</span><span class=p>)</span>  
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>The most common method to perform histogram equalization is to process every channel in the RGB image separately and then stack them together to form another RGB image.</p><p>Following this approach, we performed the first histogram equalization using the built-in function in OpenCV which takes in input an array of values and outputs the equalized array of values. The input and output are of type <strong>np.uint8</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_path</span> <span class=o>=</span> <span class=s2>&#34;../../../images/used_images/light_dark/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>img_name</span> <span class=o>=</span> <span class=s2>&#34;DSC_0015.JPG&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># reading the image</span>
</span></span><span class=line><span class=cl><span class=n>img_rgb</span> <span class=o>=</span> <span class=n>read_img</span><span class=p>(</span><span class=n>img_path</span><span class=o>+</span><span class=n>img_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Image Shape: &#34;</span><span class=p>,</span> <span class=n>img_rgb</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Image Shape:  (4000, 6000, 3)
</code></pre><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Creating the histogram for every channel</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_7_0.png width=1485 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_7_0_hu2231513932650292054.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_7_0_hu11814926614528840573.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=284 data-flex-basis=682px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># function to equalize every channel and then put together again</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>equalize_rgb_channels</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>img_rgb_equalized</span> <span class=o>=</span> <span class=n>img_rgb</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>r_equal</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_rgb_equalized</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>g_equal</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_rgb_equalized</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>b_equal</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_rgb_equalized</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r_equal</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>equalizeHist</span><span class=p>(</span><span class=n>r_equal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g_equal</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>equalizeHist</span><span class=p>(</span><span class=n>g_equal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b_equal</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>equalizeHist</span><span class=p>(</span><span class=n>b_equal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>((</span><span class=n>r_equal</span><span class=p>,</span><span class=n>g_equal</span><span class=p>,</span><span class=n>b_equal</span><span class=p>),</span><span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res_rgb_equal</span> <span class=o>=</span> <span class=n>equalize_rgb_channels</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>res_rgb_equal</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_8_0.png width=1485 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_8_0_hu6814341903248264962.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_8_0_hu3226370494791672324.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=284 data-flex-basis=682px></p><p>In the first figure we can clearly see that none of the histograms resembles a uniform distribution, on the opposite the 3 histograms have a high spike on the left end of the graph, meaning a majority of dark colors and low-intensity is present, as indeed is expected from the big influence of the background.</p><p>In the second figure instead, the histograms were stretched to approximate a uniform distribution. That can be seen from the line of the cumulative distribution that is constantly increasing closely following a line.</p><h3 id=hsi-intensity-equalization>HSI intensity equalization</h3><p>The second technique foresees that the images need first to be transformed into another color space the HSI. In the HSI color space, the three channels are Hue, Saturation and Intensity. In this color space, the intensity is not scattered among three different channels as it happens to be in RGB.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Some code to create the histograms and images </span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>):</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=s1>&#39;Intensity Histogram in HSI color space and corresponding image&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fig</span><span class=o>.</span><span class=n>set_size_inches</span><span class=p>(</span><span class=mf>18.5</span><span class=p>,</span> <span class=mf>5.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>hist</span><span class=p>,</span><span class=n>_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>histogram</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>flatten</span><span class=p>(),</span><span class=mi>256</span><span class=p>,[</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>cdf</span> <span class=o>=</span> <span class=n>hist</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cdf_normalized</span> <span class=o>=</span> <span class=n>cdf</span> <span class=o>*</span> <span class=nb>float</span><span class=p>(</span><span class=n>hist</span><span class=o>.</span><span class=n>max</span><span class=p>())</span> <span class=o>/</span> <span class=n>cdf</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>hist</span><span class=p>((</span><span class=n>img_hsi</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>])</span><span class=o>.</span><span class=n>ravel</span><span class=p>(),</span><span class=mi>256</span><span class=p>,[</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>cdf_normalized</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>legend</span><span class=p>((</span><span class=s1>&#39;cdf&#39;</span><span class=p>,</span><span class=s1>&#39;histogram&#39;</span><span class=p>),</span> <span class=n>loc</span> <span class=o>=</span> <span class=s1>&#39;upper left&#39;</span><span class=p>)</span>        
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>First of all we read the image and the convert it to HSI color space using the function defined in the helper function at the top of the notebook. We also normalize it to have values between 0 and 255.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert previously used image to HSI</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi</span> <span class=o>=</span> <span class=n>rgb_to_HSI</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi_norm</span> <span class=o>=</span> <span class=n>float_to_int_HSI</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi_norm</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>/tmp/ipykernel_1185600/3278179033.py:11: RuntimeWarning: invalid value encountered in cast
  img_hsi_norm[:,:,0] = np.uint8((img_hsi_copy[:,:,0] / (2 * np.pi)) * 255)
</code></pre><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_14_1.png width=1477 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_14_1_hu9845193765797813041.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_14_1_hu1019535873429411187.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=282 data-flex-basis=679px></p><p>We then normalize the image</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_hsi_equalized</span> <span class=o>=</span> <span class=n>img_hsi_norm</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi_equalized</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>equalizeHist</span><span class=p>(</span><span class=n>img_hsi_equalized</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi_equalized</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_16_0.png width=1477 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_16_0_hu11763716938436234542.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_16_0_hu16514123241189207107.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=282 data-flex-basis=679px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_hsi_equalized_float</span> <span class=o>=</span> <span class=n>int_to_float_HSI</span><span class=p>(</span><span class=n>img_hsi_equalized</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>new_img_rgb</span> <span class=o>=</span> <span class=n>HSI_to_rgb</span><span class=p>(</span><span class=n>img_hsi_equalized_float</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>new_img_rgb_contrasted</span> <span class=o>=</span> <span class=n>normalize_rgb</span><span class=p>(</span><span class=n>new_img_rgb</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>new_img_rgb_contrasted</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_17_0.png width=1516 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_17_0_hu10100012357250475778.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_17_0_hu3750411245218337105.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=290 data-flex-basis=697px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>compare</span><span class=p>(</span><span class=n>img1</span><span class=p>,</span> <span class=n>img2</span><span class=p>,</span> <span class=n>titles</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>img1</span><span class=p>,</span><span class=n>img2</span><span class=p>))</span> <span class=c1>#stacking images side-by-side</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1> vs </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>titles</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>titles</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>res</span><span class=p>,</span><span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>compare</span><span class=p>(</span><span class=n>res_rgb_equal</span><span class=p>,</span> <span class=n>new_img_rgb_contrasted</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;Equalized RGB&#34;</span><span class=p>,</span> <span class=s2>&#34;Equalized HSI&#34;</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_19_0.png width=1614 height=582 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_19_0_hu9733919739940302284.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_19_0_hu5084286680109831306.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=277 data-flex-basis=665px></p><h3 id=the-same-result-was-reproduced-with-another-base-image-to-check-that-the-results-were-similar-and-coherrent>The same result was reproduced with another base image to check that the results were similar and coherrent</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_path</span> <span class=o>=</span> <span class=s2>&#34;./&#34;</span>
</span></span><span class=line><span class=cl><span class=n>img_name</span> <span class=o>=</span> <span class=s2>&#34;lenna.png&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># reading the image</span>
</span></span><span class=line><span class=cl><span class=n>img_rgb_lenna</span> <span class=o>=</span> <span class=n>read_img</span><span class=p>(</span><span class=n>img_path</span><span class=o>+</span><span class=n>img_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Image Shape: &#34;</span><span class=p>,</span> <span class=n>img_rgb_lenna</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>Image Shape:  (330, 330, 3)
</code></pre><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert previously used image to HSI</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi_lenna</span> <span class=o>=</span> <span class=n>rgb_to_HSI</span><span class=p>(</span><span class=n>img_rgb_lenna</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi_norm_lenna</span> <span class=o>=</span> <span class=n>float_to_int_HSI</span><span class=p>(</span><span class=n>img_hsi_lenna</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi_norm_lenna</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_22_0.png width=1384 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_22_0_hu966852839423090804.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_22_0_hu10773064309437303913.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=265 data-flex-basis=636px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_hsi_equalized_lenna</span> <span class=o>=</span> <span class=n>img_hsi_norm_lenna</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>img_hsi_equalized_lenna</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>equalizeHist</span><span class=p>(</span><span class=n>img_hsi_equalized_lenna</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi_equalized_lenna</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_23_0.png width=1384 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_23_0_hu13694276151590558567.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_23_0_hu15019000689748630708.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=265 data-flex-basis=636px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_hsi_equalized_float_lenna</span> <span class=o>=</span> <span class=n>int_to_float_HSI</span><span class=p>(</span><span class=n>img_hsi_equalized_lenna</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>new_img_rgb_lenna</span> <span class=o>=</span> <span class=n>HSI_to_rgb</span><span class=p>(</span><span class=n>img_hsi_equalized_float_lenna</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>new_img_rgb_contrasted_lenna</span> <span class=o>=</span> <span class=n>normalize_rgb</span><span class=p>(</span><span class=n>new_img_rgb_lenna</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>new_img_rgb_contrasted_lenna</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_24_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_24_0_hu11422249836924227839.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_24_0_hu17947331369576984967.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><h2 id=2-contrast-streching>2. Contrast streching</h2><p>we implemented contrast stretching as proposed in chapter 3.2 in the book Digital Image Processing proposed as reading material in CV701. In this case we use two values namely alpha1 and alpha2, that delimits the starting point and endingn point of the streching zone in the input mapping. We then create a linear function that maps the input to an output in the range defined by beta1 and beta2. The full code is implemented in following cell.</p><p><img src=/image.png loading=lazy alt="Alt text"></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># the main function to stretch the image -&gt; general</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>contrast_stretch_channel</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>image</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Image must be of only one channel&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>beta</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>beta</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Alpha and beta must be positive&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>255</span> <span class=ow>or</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>255</span> <span class=ow>or</span> <span class=n>beta</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>255</span> <span class=ow>or</span> <span class=n>beta</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s2>&#34;Alpha and beta must be smaller than 256&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>max_val</span> <span class=o>=</span> <span class=mi>255</span> <span class=c1># fixed for 8 bit images    </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>alpha1</span> <span class=o>=</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>alpha2</span> <span class=o>=</span> <span class=n>alpha</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>beta1</span> <span class=o>=</span> <span class=n>beta</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>beta2</span> <span class=o>=</span> <span class=n>beta</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>img_bit_mask_1</span> <span class=o>=</span> <span class=n>c</span> <span class=o>&lt;=</span> <span class=n>alpha1</span>    
</span></span><span class=line><span class=cl>    <span class=n>img_bit_mask_2</span> <span class=o>=</span> <span class=p>(</span><span class=n>alpha1</span> <span class=o>&lt;</span> <span class=n>c</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>c</span> <span class=o>&lt;</span> <span class=n>alpha2</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=n>img_bit_mask_3</span> <span class=o>=</span> <span class=n>alpha2</span> <span class=o>&lt;=</span> <span class=n>c</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>s1</span> <span class=o>=</span> <span class=p>(</span><span class=n>beta1</span> <span class=o>/</span> <span class=p>(</span><span class=n>alpha1</span> <span class=o>+</span> <span class=mf>1E-20</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>s2</span> <span class=o>=</span> <span class=p>((</span><span class=n>beta2</span> <span class=o>-</span> <span class=n>beta1</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>alpha2</span> <span class=o>-</span> <span class=n>alpha1</span> <span class=o>+</span> <span class=mf>1E-20</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b2</span> <span class=o>=</span> <span class=n>beta2</span> <span class=o>-</span> <span class=n>alpha2</span> <span class=o>*</span> <span class=n>s2</span>
</span></span><span class=line><span class=cl>    <span class=n>s3</span> <span class=o>=</span> <span class=p>((</span><span class=n>max_val</span> <span class=o>-</span> <span class=n>beta2</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>max_val</span> <span class=o>-</span> <span class=n>alpha2</span> <span class=o>+</span> <span class=mf>1E-20</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>b3</span> <span class=o>=</span> <span class=n>max_val</span> <span class=o>-</span> <span class=n>max_val</span> <span class=o>*</span> <span class=n>s3</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>cn</span><span class=p>[</span><span class=n>img_bit_mask_1</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=p>[</span><span class=n>img_bit_mask_1</span><span class=p>]</span> <span class=o>*</span> <span class=n>s1</span>            
</span></span><span class=line><span class=cl>    <span class=n>cn</span><span class=p>[</span><span class=n>img_bit_mask_2</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=p>[</span><span class=n>img_bit_mask_2</span><span class=p>]</span> <span class=o>*</span> <span class=n>s2</span> <span class=o>+</span> <span class=n>b2</span>        
</span></span><span class=line><span class=cl>    <span class=n>cn</span><span class=p>[</span><span class=n>img_bit_mask_3</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=p>[</span><span class=n>img_bit_mask_3</span><span class=p>]</span> <span class=o>*</span> <span class=n>s3</span> <span class=o>+</span> <span class=n>b3</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>cn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>contrast_stretch_RGB</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>rn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>rn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>([</span><span class=n>rn</span><span class=p>,</span> <span class=n>gn</span><span class=p>,</span> <span class=n>bn</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Reading the image and plot the original hsitograms</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_path</span> <span class=o>=</span> <span class=s2>&#34;../../../images/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>img_name</span> <span class=o>=</span> <span class=s2>&#34;example3.png&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img_rgb</span> <span class=o>=</span> <span class=n>read_img</span><span class=p>(</span><span class=n>img_path</span> <span class=o>+</span> <span class=n>img_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_28_0.png width=1516 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_28_0_hu17035706498362058798.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_28_0_hu3131210414598518117.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=290 data-flex-basis=697px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_path</span> <span class=o>=</span> <span class=s2>&#34;./&#34;</span>
</span></span><span class=line><span class=cl><span class=n>img_name</span> <span class=o>=</span> <span class=s2>&#34;lenna.png&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>img_rgb</span> <span class=o>=</span> <span class=n>read_img</span><span class=p>(</span><span class=n>img_path</span> <span class=o>+</span> <span class=n>img_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_29_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_29_0_hu16599647306902370405.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_29_0_hu12700600845169007332.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><p>We start our series of exepriments by changing the values of alpha and beta.</p><ol><li>Leaving alpha and beta with the same values should give us the same exact image, since every intensity is mapped to the same intensity</li><li>We decrease the range of beta and shift it to the right end of the image. This should produce a very light image, indeed.</li><li>The next to images we decrease the range of the values in output and we shift them to the left-end of the histogram, so the image becomes even darker</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_31_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_31_0_hu16599647306902370405.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_31_0_hu12700600845169007332.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_32_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_32_0_hu7035208145948480416.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_32_0_hu11872261613519841460.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>150</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_33_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_33_0_hu5511040839816503904.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_33_0_hu2915110652650167936.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_34_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_34_0_hu13969709232758787965.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_34_0_hu9539992200132704626.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>235</span><span class=p>],</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_35_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_35_0_hu17949766580483078872.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_35_0_hu9594973012518912118.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>200</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_36_0.png width=1507 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_36_0_hu8615607387241124712.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_36_0_hu10034050813835059046.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=288 data-flex-basis=692px></p><h3 id=clipping>Clipping</h3><p>When alpha1 and alpha2 are arbitrary values but beta1 = 0 and beta2 = 255</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>img_stretched</span> <span class=o>=</span> <span class=n>contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>150</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_38_0.png width=1507 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_38_0_hu11752722323922779641.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_38_0_hu10274232225894081639.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=288 data-flex-basis=692px></p><p>given the modularity of the function <strong>stretch_channel</strong> we can also modify each channel with its own alpha and value, to get the most contrast out of the image. In this way we have more control over the stretching parameters and it can be calibrated to each min and max of each channel for a better outcome.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>custom_contrast_stretch_RGB</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>alphas</span><span class=p>,</span> <span class=n>betas</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>rn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>gn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>bn</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>rn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>alphas</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>betas</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>gn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>g</span><span class=p>,</span> <span class=n>alphas</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>betas</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>bn</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>b</span><span class=p>,</span> <span class=n>alphas</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>betas</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>([</span><span class=n>rn</span><span class=p>,</span> <span class=n>gn</span><span class=p>,</span> <span class=n>bn</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>alphas</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>60</span><span class=p>,</span><span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>230</span><span class=p>],</span> <span class=p>[</span><span class=mi>45</span><span class=p>,</span><span class=mi>220</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>betas</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>custom_img_stretched</span> <span class=o>=</span> <span class=n>custom_contrast_stretch_RGB</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>,</span> <span class=n>alphas</span><span class=p>,</span> <span class=n>betas</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>custom_img_stretched</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_40_0.png width=1498 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_40_0_hu18288636110775672454.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_40_0_hu874670331535907865.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=286 data-flex-basis=688px></p><p>Last the process can also be repeated for an HSI image, by stretching the I channel. Implmenting this as follows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>img_hsi_norm</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_42_0.png width=1477 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_42_0_hu9845193765797813041.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_42_0_hu1019535873429411187.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=282 data-flex-basis=679px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>plot_his_and_rgb</span><span class=p>(</span><span class=n>image</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>stretched_hsi_imgage</span> <span class=o>=</span> <span class=n>image</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>stretched_hsi_imgage</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>stretched_hsi_imgage</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>],</span> <span class=n>alpha</span><span class=p>,</span> <span class=n>beta</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>create_histogram_hsi</span><span class=p>(</span><span class=n>stretched_hsi_imgage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_equalized_float</span> <span class=o>=</span> <span class=n>int_to_float_HSI</span><span class=p>(</span><span class=n>stretched_hsi_imgage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>new_img_rgb</span> <span class=o>=</span> <span class=n>HSI_to_rgb</span><span class=p>(</span><span class=n>img_hsi_equalized_float</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>new_img_rgb</span> <span class=o>=</span> <span class=n>normalize_rgb</span><span class=p>(</span><span class=n>new_img_rgb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>create_histogram_rgb</span><span class=p>(</span><span class=n>new_img_rgb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>new_img_rgb</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>new_hsi_stretched</span> <span class=o>=</span> <span class=n>plot_his_and_rgb</span><span class=p>(</span><span class=n>img_hsi_norm</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>150</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>240</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_44_0.png width=1477 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_44_0_hu2162696440877901518.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_44_0_hu14417385595953799318.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=282 data-flex-basis=679px></p><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_44_1.png width=1485 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_44_1_hu4920580691192464104.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_44_1_hu2695966405281454401.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=284 data-flex-basis=682px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>plot_his_and_rgb</span><span class=p>(</span><span class=n>img_hsi_norm</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>245</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_45_0.png width=1477 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_45_0_hu6097928960700031187.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_45_0_hu6302332386569930124.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=282 data-flex-basis=679px></p><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_45_1.png width=1485 height=522 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_45_1_hu4714716992991641621.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_45_1_hu9478256951139508250.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=284 data-flex-basis=682px></p><h2 id=thresholding>Thresholding</h2><p>Thresholding is another particular case of contrast stretching. It is when both alpha are the same and beta are the extremes, namely 0-255.
Some experiments were performed with different thresholds</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>bw_image</span> <span class=o>=</span> <span class=n>img_rgb</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bw_image</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>bw_image</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_RGB2GRAY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>alphas</span> <span class=o>=</span> <span class=p>[[</span><span class=mi>50</span><span class=p>,</span><span class=mi>50</span><span class=p>],</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=p>[</span><span class=mi>150</span><span class=p>,</span> <span class=mi>150</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># stack images side-by-side</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=p>,</span> <span class=n>axs</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=s1>&#39;Thresholding with different alpha values&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>set_size_inches</span><span class=p>(</span><span class=mf>18.5</span><span class=p>,</span> <span class=mf>5.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>alphas</span><span class=p>):</span>    
</span></span><span class=line><span class=cl>    <span class=c1>#axs[0].legend((alpha), loc = &#39;upper left&#39;)        </span>
</span></span><span class=line><span class=cl>    <span class=n>axs</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>contrast_stretch_channel</span><span class=p>(</span><span class=n>bw_image</span><span class=p>,</span> <span class=n>alpha</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>255</span><span class=p>]),</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;gray&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>[]
</code></pre><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_47_1.png width=1489 height=521 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_47_1_hu12128930854581354963.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_47_1_hu7700886256962790060.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=285 data-flex-basis=685px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>### Comparing the results of the different methods</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>compare</span><span class=p>(</span><span class=n>custom_img_stretched</span><span class=p>,</span> <span class=n>new_img_rgb_contrasted_lenna</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;Image maximally stretched on different channels RGB&#34;</span><span class=p>,</span> <span class=s2>&#34;Histogram Equalized image on HSI&#34;</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_48_0.png width=1596 height=836 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_48_0_hu5149884561482729865.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_48_0_hu3077202730368988000.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=190 data-flex-basis=458px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>### Comparing the results of the different methods</span>
</span></span><span class=line><span class=cl><span class=n>compare</span><span class=p>(</span><span class=n>new_img_rgb_contrasted</span><span class=p>,</span> <span class=n>new_hsi_stretched</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;Histogram Equalized HSI image&#34;</span><span class=p>,</span> <span class=s2>&#34;Contrast stretched image on HSI&#34;</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/04_notebook/assignment01/task_2.2_files/task_2.2_49_0.png width=1614 height=582 srcset="/04_notebook/assignment01/task_2.2_files/task_2.2_49_0_hu12942225326877432017.png 480w, /04_notebook/assignment01/task_2.2_files/task_2.2_49_0_hu2962138301486507631.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=277 data-flex-basis=665px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span><span class=lnt>98
</span><span class=lnt>99
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># some general and helper functions</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>float_to_int_HSI</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Expected input:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 1 =&gt; H =&gt; [0, 2pi]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 2 =&gt; S =&gt; [0, 1]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 3 =&gt; I =&gt; [0, 1]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_copy</span> <span class=o>=</span> <span class=n>img_hsi</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=n>img_hsi_copy</span><span class=o>.</span><span class=n>shape</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>((</span><span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>))</span> <span class=o>*</span> <span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>*</span> <span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>img_hsi_norm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>int_to_float_HSI</span><span class=p>(</span><span class=n>img_hsi</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Expected input:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 1 =&gt; H =&gt; [0, 255]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 2 =&gt; S =&gt; [0, 255]</span>
</span></span><span class=line><span class=cl>    <span class=c1>#   channel 3 =&gt; I =&gt; [0, 255]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_copy</span> <span class=o>=</span> <span class=n>img_hsi</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=p>(</span><span class=n>img_hsi_copy</span><span class=o>.</span><span class=n>shape</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span> <span class=o>/</span> <span class=mi>255</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span> <span class=o>/</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>    <span class=n>img_hsi_norm</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=n>img_hsi_copy</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span> <span class=o>/</span> <span class=mi>255</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>img_hsi_norm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>normalize_rgb</span><span class=p>(</span><span class=n>img_rgb</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img_rgb_copy</span> <span class=o>=</span> <span class=n>img_rgb</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>(</span><span class=n>img_rgb_copy</span> <span class=o>*</span> <span class=mi>255</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_img</span><span class=p>(</span><span class=n>img_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>imageio</span><span class=o>.</span><span class=n>v3</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>img_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>HSI_to_rgb</span><span class=p>(</span><span class=n>img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span> <span class=mi>0</span><span class=p>]</span> <span class=c1># expected range [0, 2pi] we actually should get from 0 to 1 as well</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span> <span class=mi>1</span><span class=p>]</span> <span class=c1># expected range [0, 1]</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>img</span><span class=p>[:,:,</span> <span class=mi>2</span><span class=p>]</span> <span class=c1># expected range [0, 1]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>h1</span> <span class=o>=</span> <span class=n>h</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span>
</span></span><span class=line><span class=cl>    <span class=n>h2</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>&lt;=</span> <span class=n>h</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>h</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h3</span> <span class=o>=</span> <span class=mi>2</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>&lt;=</span> <span class=n>h</span>     
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>h_curr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># case 1</span>
</span></span><span class=line><span class=cl>    <span class=n>h_curr</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>=</span> <span class=n>h</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>[</span><span class=n>h1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>h_curr</span><span class=p>[</span><span class=n>h1</span><span class=p>]))</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>3</span> <span class=o>-</span> <span class=n>h_curr</span><span class=p>[</span><span class=n>h1</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>i</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=n>h1</span><span class=p>]</span> <span class=o>+</span> <span class=n>b</span><span class=p>[</span><span class=n>h1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># case 2    </span>
</span></span><span class=line><span class=cl>    <span class=n>h_curr</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>=</span> <span class=n>h</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=mi>2</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>[</span><span class=n>h2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>h_curr</span><span class=p>[</span><span class=n>h2</span><span class=p>]))</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>3</span> <span class=o>-</span> <span class=n>h_curr</span><span class=p>[</span><span class=n>h2</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>i</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=n>h2</span><span class=p>]</span> <span class=o>+</span> <span class=n>g</span><span class=p>[</span><span class=n>h2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># case 3</span>
</span></span><span class=line><span class=cl>    <span class=n>h_curr</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>=</span> <span class=n>h</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=mi>4</span><span class=o>/</span><span class=mi>3</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>[</span><span class=n>h3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>h_curr</span><span class=p>[</span><span class=n>h3</span><span class=p>]))</span> <span class=o>/</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>3</span> <span class=o>-</span> <span class=n>h_curr</span><span class=p>[</span><span class=n>h3</span><span class=p>])))</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>i</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>g</span><span class=p>[</span><span class=n>h3</span><span class=p>]</span> <span class=o>+</span> <span class=n>b</span><span class=p>[</span><span class=n>h3</span><span class=p>])</span>    
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>r</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span> <span class=o>=</span> <span class=n>g</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=n>b</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>((</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>,</span><span class=n>b</span><span class=p>),</span><span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rgb_to_HSI</span><span class=p>(</span><span class=n>img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>np</span><span class=o>.</span><span class=n>errstate</span><span class=p>(</span><span class=n>divide</span><span class=o>=</span><span class=s2>&#34;ignore&#34;</span><span class=p>,</span> <span class=n>invalid</span><span class=o>=</span><span class=s2>&#34;ignore&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># load image with 32 floating point type</span>
</span></span><span class=line><span class=cl>        <span class=n>rgb</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>(</span><span class=n>img</span><span class=p>)</span><span class=o>/</span><span class=mf>255.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Separating RGB    </span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>rgb</span><span class=p>[:,:,</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span> <span class=o>=</span> <span class=n>rgb</span><span class=p>[:,:,</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>rgb</span><span class=p>[:,:,</span><span class=mi>2</span><span class=p>]</span>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Intensity</span>
</span></span><span class=line><span class=cl>        <span class=n>intensity</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span><span class=o>+</span><span class=n>b</span><span class=o>+</span><span class=n>g</span><span class=p>)</span><span class=o>/</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Saturation</span>
</span></span><span class=line><span class=cl>        <span class=nb>min</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>minimum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>minimum</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=n>g</span><span class=p>),</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sat</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>((</span><span class=mi>3</span><span class=o>/</span><span class=p>(</span><span class=n>r</span><span class=o>+</span><span class=n>g</span><span class=o>+</span><span class=n>b</span><span class=o>+</span><span class=mf>0.0000001</span><span class=p>))</span><span class=o>*</span><span class=nb>min</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Hue</span>
</span></span><span class=line><span class=cl>        <span class=n>hue</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arccos</span><span class=p>((</span><span class=mf>0.5</span><span class=o>*</span><span class=p>((</span><span class=n>r</span><span class=o>-</span><span class=n>g</span><span class=p>)</span><span class=o>+</span><span class=p>(</span><span class=n>r</span><span class=o>-</span><span class=n>b</span><span class=p>)))</span><span class=o>/</span><span class=p>((</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>((</span><span class=n>r</span><span class=o>-</span><span class=n>g</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=o>+</span><span class=p>(</span><span class=n>r</span><span class=o>-</span><span class=n>b</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>g</span><span class=o>-</span><span class=n>b</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>        <span class=n>hue</span><span class=p>[</span><span class=n>b</span><span class=o>&gt;</span><span class=n>g</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>-</span> <span class=n>hue</span><span class=p>[</span><span class=n>b</span><span class=o>&gt;</span><span class=n>g</span><span class=p>]</span>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>((</span><span class=n>hue</span><span class=p>,</span><span class=n>sat</span><span class=p>,</span><span class=n>intensity</span><span class=p>),</span><span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>     
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><div class="article-list--compact links"><article><a href=./Assignment_1_CV.pdf target=_blank rel=noopener><div class=article-details><h2 class=article-title>Complete PDF report</h2><footer class=article-time>Click on the link to download the full report</footer></div></a></article></div><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Sebastian Cavada</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>